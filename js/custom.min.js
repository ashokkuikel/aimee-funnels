$(function() {
    var $avgRevenue = 100;
    var $comRate = 14;
    var $displayOutput = 0;
    $("#avg-revenue-slider-range").slider({
        range: "max",
        min: 10,
        max: 8000,
        value: 600,
        slide: function(event, ui) {
            $avgRevenue = ui.value;
            $(this).parents(".scoller-1").find("#avg-revenue-text").val("£" + $avgRevenue);
            resultValidate($avgRevenue, $comRate);
        }
    });
    $avgRevenue = $("#avg-revenue-slider-range").slider("value");
    $("#avg-revenue-text").val("£" + $avgRevenue);
    $("#comm-rate-slider-range").slider({
        range: "max",
        min: 2,
        max: 100,
        value: 14,
        slide: function(event, ui) {
            $comRate = ui.value;
            $(this).parents(".scoller-2").find("#comm-rate-text").val($comRate + "%");
            resultValidate($avgRevenue, $comRate);
        }
    });
    $comRate = $("#comm-rate-slider-range").slider("value");
    $("#comm-rate-text").val($comRate + "%");

    resultValidate($avgRevenue, $comRate);

});


function resultValidate($avgRevenue, $comRate) {

    var $displayNum = parseFloat($avgRevenue * $comRate / 100) - 60;

    if ($displayNum > 0) {
        $("#text-display-total").multiline("£" + $displayNum.toFixed(2) + "span\nTotal Saving\span");
    } else {
        $("#text-display-total").multiline("£0span\nTotal Saving\span");
    }
}

$.fn.multiline = function(text) {
    this.text(text);
    this.html(this.html().replace(/\n/g, '<br/>'));
    this.html(this.html().replace(/\span/g, '</span>'));
    this.html(this.html().replace(/span/g, '<span class="price-text">'));
    return this;
}